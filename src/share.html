<extends src="base.html">
	<block name="title">
		Share
	</block>
	<block name="main">
		<h2 id="sharing">Share with me!</h2>
		<form
			action="success.html"
			data-netlify="true"
			enctype="application/x-www-form-urlencoded"
			id="shareForm"
			method="POST"
			name="share"
		>
			<label>
				Title:
				<input name="title" placeholder="What are you sharing?" />
			</label>
			<label>
				Url:
				<input
					type="url"
					name="url"
					placeholder="https://www.example.com"
				/>
			</label>
			<label>
				Text:
				<textarea
					name="text"
					placeholder="Why are you sharing it?"
				></textarea>
			</label>
			<fieldset>
				<h3>Who are you?</h3>
				<label> Name: <input name="name" autocomplete="name" placeholder="Your Name" /> </label>
				<label>
					Email:
					<input type="email" name="email" autocomplete="email" placeholder="your@email.com" />
				</label>
			</fieldset>
			<button type="submit">Share</button>
		</form>
		<script>
			const form = document.forms.share;

			// prepopulate form with query params
			const params = new URL(location).searchParams;
			form.title.value = params.get('title');
			form.text.value = params.get('text');
			form.url.value = params.get('url');

			// load previously used name and email
			form.name.value = localStorage.getItem('name');
			form.email.value = localStorage.getItem('email');

			// save the name and email in local storage till next time
			form.onsubmit = (event) => {
				console.debug('saving name and email', event.target);
				localStorage.setItem('name', event.target.name.value);
				localStorage.setItem('email', event.target.email.value);
			};

			console.debug('share.html script executed');
		</script>
	</block>
</extends>
