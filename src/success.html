<extends src="base.html">
	<block name="title">
		Success
	</block>
	<block name="main">
		<h2>Thanks for Sharing!</h2>
		<share-list></share-list>
		<script type="module">
			import {
				html,
				component,
				useState,
				useEffect,
			} from 'https://cdn.pika.dev/haunted';

			customElements.define('share-list', component(ShareList));

			function ShareList() {
				const [items, setItems] = useState([]);

				useEffect(async () => {
					const res = await fetch('.netlify/functions/shares');
					const data = await res.json();
					setItems(data);
					console.log('âš¡', data);
				}, []);
				
				return html`
					<section>
						${items.map(
							(item) =>
								html`
									<article>
										<h3><a href="${item.url}" target="_blank">${item.title}</a></h3>
										<p>${item.text}</p>
										<blockquote>
											${item.name}	
										</blockquote
									</article>
								`,
						)}
					</section>
				`;
			}
		</script>
	</block>
</extends>
